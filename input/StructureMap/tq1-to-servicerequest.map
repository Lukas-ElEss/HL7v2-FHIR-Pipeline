map "http://hsrt-kkrt.org/fhir/StructureMap/TQ1-to-ServiceRequest" = "TQ1toServiceRequest"

uses "http://hsrt-kkrt.org/fhir/StructureDefinition/TQ1Segment" as source
uses "http://hl7.org/fhir/StructureDefinition/ServiceRequest" as target

group TQ1toServiceRequest(source tq1 : TQ1Segment, target sr : ServiceRequest) {

  // Occurrence Timing -> boundsPeriod
  sr.occurrenceTiming -> create('Timing') as tm then {
    tm.repeat -> create('TimingRepeatComponent') as rpt then {
      rpt.boundsPeriod -> create('Period') as prd then {
        tq1.TQ1_7 -> prd.start;
        tq1.TQ1_8 -> prd.end;
      };
    };
  };
}
